// ==UserScript==
// @name        Agar Extended 2 (wersja Firefox)
// @namespace   AE
// @description Port dodatku Agar Extended 2 dla pszemka bezbeka
// @include     http://agar.io/
// @version     1
// @grant       none
// @author      DJ_MuTeD
// @run-at document-start
// ==/UserScript==


var changed = 0; // script need to be edited with

window.addEventListener('beforescriptexecute', function (e) {

	//for external script:
	src = e.target.src;
	if (src.search(/main_out\.js..../) != -1) {
		console.log('event listener fired, main_out found');
		changed++;
		e.preventDefault();
		e.stopPropagation();
		append(main_out);
		//init();
	};

	//when done, remove the listener:
	if (changed == 1)
		window.removeEventListener(e.type, arguments.callee, true);

}, true);

////// append with new block function:
function append(s) {
	console.log('append fired');
	document.head.appendChild(document.createElement('script'))
	.innerHTML = s.toString().replace(/^function.*{|}$/g, '');
}

////////////////////////////////////////////////
function main_out() {
function sleep(e){for(e+=(new Date).getTime();new Date<e;);}function pp(e){"undefined"!=typeof Parse&&(_pp===!1&&(_pp=!0,Parse.initialize("Ir0ObUir81Zr4aC0Pdy41XxwPGeKkf7qX8PgxQZ3","h1ZsdM2jC2aigsAkE9rE9OSc63erGK4IKRlvGJ27")),"undefined"!=typeof e&&e())}"undefined"==typeof jQuery&&(sleep(2500),"undefined"==typeof jQuery&&(window.location="http://agar.io/"));var _pp=!1;!function(e,t,n){function i(){s(),-1!=window.navigator.language.indexOf("ru")?P():I(),N(),setInterval(s,18e4),V=B=document.getElementById("canvas"),L=V.getContext("2d"),V.onmousedown=function(e){if(Ee){var t=e.clientX-(5+Y/5/2),n=e.clientY-(5+Y/5/2);if(Math.sqrt(t*t+n*n)<=Y/5/2)return g(),void k(17)}m(),g()},V.onmousemove=function(e){te=e.clientX,ne=e.clientY,m()},V.onmouseup=function(e){};var n=!1,i=!1,a=!1;e.onkeydown=function(e){32==e.keyCode&&(n||(g(),k(17),n=!0,O())),81==e.keyCode&&(i||(k(18),i=!0)),87==e.keyCode&&(a||(g(),k(21),a=!0)),27==e.keyCode&&t("#overlays").toggle(200)},e.onkeyup=function(e){32==e.keyCode&&(n=!1),87==e.keyCode&&(a=!1),81==e.keyCode&&i&&(k(19),i=!1)},e.onblur=function(){k(19),a=i=n=!1},e.onresize=v,v(),e.requestAnimationFrame?e.requestAnimationFrame(x):setInterval(w,1e3/60),setInterval(g,100),o(t("#region").val())}function a(){for(var e=Number.POSITIVE_INFINITY,t=Number.POSITIVE_INFINITY,n=Number.NEGATIVE_INFINITY,i=Number.NEGATIVE_INFINITY,a=0,s=0;s<K.length;s++)a=Math.max(K[s].size,a),e=Math.min(K[s].x,e),t=Math.min(K[s].y,t),n=Math.max(K[s].x,n),i=Math.max(K[s].y,i);for(R=QUAD.init({minX:e-(a+100),minY:t-(a+100),maxX:n+(a+100),maxY:i+(a+100)}),s=0;s<K.length;s++)if(e=K[s],e.shouldRender())for(t=0;t<e.points.length;++t)R.insert(e.points[t])}function s(){null==Ue&&(Ue={},t("#region").children().each(function(){var e=t(this),n=e.val();n&&(Ue[n]=e.text())})),t.get("http://m.agar.io/info",function(e){var n;for(n in e.regions)t('#region option[value="'+n+'"]').text(Ue[n]+" ("+e.regions[n].numPlayers+" players)")},"json")}function o(e){e&&e!=me&&(me=e,l())}function r(){console.log("Find "+me+Oe),t.ajax("http://m.agar.io/",{error:function(){setTimeout(r,1e3)},success:function(e){e=e.split("\n"),c("ws://"+e[0])},dataType:"text",method:"POST",cache:!1,crossDomain:!0,data:me+Oe||"?"})}function l(){t("#connecting").show(),r()}function c(e){G&&(G.onopen=null,G.onmessage=null,G.onclose=null,G.close(),G=null),W=[],H=[],Q={},K=[],J=[],ee=[],Ce=null,Ae=-1,console.log("Connecting to "+e),D(e),G=new WebSocket(e),G.binaryType="arraybuffer",G.onopen=h,G.onmessage=u,G.onclose=p,G.onerror=function(){console.log("socket error")}}function h(e){t("#connecting").hide(),n(".btn-needs-server").prop("disabled",!1),console.log("socket open"),e=new ArrayBuffer(5);var i=new DataView(e);i.setUint8(0,255),i.setUint32(1,1,!0),G.send(e),f()}function p(e){console.log("socket close"),setTimeout(l,500)}function u(e){function t(){for(var e="";;){var t=i.getUint16(n,!0);if(n+=2,0==t)break;e+=String.fromCharCode(t)}return e}var n=1,i=new DataView(e.data),a=i.getUint8(0);switch(a){case 16:d(i);break;case 17:Z=i.getFloat32(1,!0),X=i.getFloat32(5,!0);break;case 20:H=[],W=[];break;case 32:W.push(i.getUint32(1,!0));break;case 48:for(ee=[];n<i.byteLength;)ee.push({id:0,name:t()});F();break;case 49:if(null!=Ce)break;e=i.getUint32(n,!0),n+=4,ee=[];for(var s=0;e>s;++s){var o=i.getUint32(n,!0);n+=4,ee.push({id:o,name:t()})}F();break;case 50:Ce=[],e=i.getUint32(n,!0),n+=4;for(var r=0;e>r;++r)Ce.push(i.getFloat32(n,!0)),n+=4;F();break;case 64:le=i.getFloat64(1,!0),ce=i.getFloat64(9,!0),he=i.getFloat64(17,!0),pe=i.getFloat64(25,!0),0==H.length&&(Z=(he+le)/2,X=(pe+ce)/2)}}function d(e){oe=+new Date;var n=Math.random(),i=1;be=!1;var a=e.getUint16(i,!0);i+=2;for(var s=0;a>s;++s){var o=Q[e.getUint32(i,!0)],r=Q[e.getUint32(i+4,!0)];i+=8,o&&r&&(r.destroy(!0),r.ox=r.x,r.oy=r.y,r.oSize=r.size,r.nx=o.x,r.ny=o.y,r.nSize=r.size,r.updateTime=oe)}for(;;){if(a=e.getUint32(i,!0),i+=4,0==a)break;s=e.getFloat32(i,!0),i+=4,pointY=e.getFloat32(i,!0),i+=4,pointSize=e.getFloat32(i,!0),i+=4;var l=e.getUint8(i);i++;var c=e.getUint8(i++),h=e.getUint8(i++);for(l=(l<<16|c<<8|h).toString(16);6>l.length;)l="0"+l;for(l="#"+l,h=e.getUint8(i++),c=!!(1&h),2&h&&(i+=4),4&h&&(i+=8),8&h&&(i+=16),h="";;){var p=e.getUint16(i,!0);if(i+=2,0==p)break;h+=String.fromCharCode(p)}p=null,p=null,Q.hasOwnProperty(a)?(p=Q[a],p.updatePos(),p.ox=p.x,p.oy=p.y,p.oSize=p.size,p.color=l):(p=new j(a,s,pointY,pointSize,l,c,h),p.pX=s,p.pY=pointY),p.nx=s,p.ny=pointY,p.nSize=pointSize,p.updateCode=n,p.updateTime=oe,-1!=W.indexOf(a)&&-1==H.indexOf(p)&&(document.getElementById("overlays").style.display="none",H.push(p),1==H.length&&(Z=p.x,X=p.y))}for(e.getUint16(i,!0),i+=2,pointY=e.getUint32(i,!0),i+=4,s=0;s<pointY;s++)a=e.getUint32(i,!0),i+=4,Q[a]&&(Q[a].updateCode=n);for(s=0;s<K.length;s++)K[s].updateCode!=n&&K[s--].destroy(!1);be&&0==H.length&&t("#overlays").fadeIn(3e3)}function m(){ie=(te-Y/2)/ue+Z,ae=(ne-q/2)/ue+X}function g(){if(null!=G&&G.readyState==G.OPEN){var e=te-Y/2,t=ne-q/2;64>e*e+t*t||(Be!=ie||Le!=ae)&&(Be=ie,Le=ae,e=new ArrayBuffer(21),t=new DataView(e),t.setUint8(0,16),t.setFloat64(1,ie,!0),t.setFloat64(9,ae,!0),t.setUint32(17,0,!0),G.send(e))}}function f(){if(null!=G&&G.readyState==G.OPEN&&null!=re){var e=new ArrayBuffer(1+2*re.length),t=new DataView(e);t.setUint8(0,0);for(var n=0;n<re.length;++n)t.setUint16(1+2*n,re.charCodeAt(n),!0);G.send(e)}}function k(e){if(null!=G&&G.readyState==G.OPEN){var t=new ArrayBuffer(1);new DataView(t).setUint8(0,e),G.send(t)}}function x(){w(),e.requestAnimationFrame(x)}function v(){Y=e.innerWidth,q=e.innerHeight,B.width=V.width=Y,B.height=V.height=q,w()}function b(){if(!Me&&0!=H.length){var e=0;$=1e7;for(var t=0;t<H.length;t++)e+=H[t].size,$>H[t].size&&($=H[t].size);e=Math.pow(Math.min(64/e,1),.4)*Math.max(q/965,Y/1920),ue=(9*ue+e)/de}}function w(){var e=+new Date;if(se++,b(),oe=+new Date,0<H.length){for(var t=0,n=0,i=0;i<H.length;i++)H[i].updatePos(),t+=H[i].x/H.length,n+=H[i].y/H.length;Z=(Z+t)/2,X=(X+n)/2}for(a(),m(),L.clearRect(0,0,Y,q),L.fillStyle=ye?"#111111":"#F2FBFF",L.fillRect(0,0,Y,q),L.save(),L.strokeStyle=ye?"#AAAAAA":"#000000",L.globalAlpha=.2,L.scale(ue,ue),t=Y/ue,n=q/ue,i=-.5+(t/2-Z)%50;t>i;i+=50)L.beginPath(),L.moveTo(i,0),L.lineTo(i,n),L.stroke();for(i=-.5+(-X+n/2)%50;n>i;i+=50)L.beginPath(),L.moveTo(0,i),L.lineTo(t,i),L.stroke();for(L.restore(),K.sort(function(e,t){return e.size==t.size?e.id-t.id:e.size-t.size}),L.save(),L.translate(Y/2,q/2),L.scale(ue,ue),L.translate(-Z,-X),_e&&M(),i=0;i<J.length;i++)J[i].draw();for(i=0;i<K.length;i++)K[i].draw();L.restore(),Ve&&(0!=ee.length||null!=Ce)&&L.drawImage(Ve,Y-Ve.width-10,10),we=Math.max(we,z()),0!=we&&(null==qe&&(qe=new S(24,"#FFFFFF")),qe.setValue("Score: "+~~(we/100)+" X: "+~~Z+" Y: "+~~X),n=qe.render(),t=n.width,L.globalAlpha=.2,L.fillStyle="#000000",L.fillRect(10,q-10-24-10,t+10,34),L.globalAlpha=1,L.drawImage(n,15,q-10-24-5)),y(),e=+new Date-e,e>1e3/60?Ye-=.01:1e3/65>e&&(Ye+=.01),.4>Ye&&(Ye=.4),Ye>1&&(Ye=1)}function y(){if(Ee&&De.width){var e=Y/5;L.drawImage(De,5,5,e,e)}}function z(){for(var e=0,t=0;t<H.length;t++)e+=H[t].nSize*H[t].nSize;return e}function F(){if(0!=ee.length||null!=Ce)if(fe||null!=Ce){Ve=document.createElement("canvas");var e=Ve.getContext("2d"),t=60;t=null==Ce?t+24*ee.length:t+180;var n=Math.min(200,.3*Y)/200;if(Ve.width=200*n,Ve.height=t*n,e.scale(n,n),e.globalAlpha=.4,e.fillStyle="#000000",e.fillRect(0,0,200,t),e.globalAlpha=1,e.fillStyle="#FFFFFF",e.font="30px Ubuntu",n="Leaderboard",e.fillText(n,100-e.measureText(n).width/2,40),null==Ce){e.font="20px Ubuntu";for(var i=0;i<ee.length;++i)n=ee[i].name||"An unnamed cell",-1!=H.indexOf(ee[i].id)&&(n=H[0].name),fe||(0==H.length||H[0].name!=n)&&(n="An unnamed cell"),-1!=W.indexOf(ee[i].id)?(H[0].name&&(name=H[0].name),e.fillStyle="#FFAAAA"):e.fillStyle="#FFFFFF",n=i+1+". "+n,e.fillText(n,100-e.measureText(n).width/2,70+24*i)}else for(t=n=0;t<Ce.length;++t)angEnd=n+Ce[t]*Math.PI*2,e.fillStyle=Se[t+1],e.beginPath(),e.moveTo(100,140),e.arc(100,140,80,n,angEnd,!1),e.fill(),n=angEnd}else Ve=null}function S(e,t,n,i){e&&(this._size=e),t&&(this._color=t),this._stroke=!!n,i&&(this._strokeColor=i)}function C(e){return-1!=$e.indexOf(e)}function A(e){return null!=T(e)}function T(e){for(var t=0;t<Ze.length;t++)if(Ze[t].contains!==!1){if(-1!=e.indexOf(Ze[t].name.toLowerCase()))return Ze[t]}else if(e===Ze[t].name.toLowerCase())return Ze[t];return null}function _(e){return e=e.toLowerCase(),C(e)||A(e)?(Re.hasOwnProperty(e)||(Re[e]=new Image,A(e)?Re[e].src=T(e).src:Re[e].src="skins/"+e+".png"),Re[e]):null}function j(e,t,n,i,a,s,o){K.push(this),Q[e]=this,this.id=e,this.ox=this.x=t,this.oy=this.y=n,this.oSize=this.size=i,this.color=a,this.isVirus=s,this.points=[],this.pointsAcc=[],this.createPoints(),this.setName(o)}function M(){ye&&(L.strokeStyle="#FFFFFF"),L.beginPath(),L.moveTo(0,0),L.lineTo(11180,0),L.lineTo(11180,11180),L.lineTo(0,11180),L.lineTo(0,0),L.stroke()}function P(){n("#nick").attr("placeholder","Ник игрока"),n("#helloDialog").css("margin","25px auto"),n("p")[0].innerHTML="Введите свой ник или оставьте поле пустым",n("#region").children().get(0).innerHTML="— Выберите сервер —",n("#playBtn").text("Играть"),n("#helloDialog > center > span.text-muted").html("Управляйте клеткой с помощью мыши.<br>Нажмите <b>Пробел</b>, чтобы разделиться.<br>Нажмите <b>W</b>, чтобы извлечь некоторую массу"),n("#helloDialog > form > div:nth-child(1) > h2 > center").text("Привет"),n("#helloDialog > center > b").html("Agar Extended 2.<br>Версия: 0.2.1.2<br>"),n("#helloDialog > div:nth-child(9) > a:nth-child(1)").text("Политика Конфиденциальности"),n("#helloDialog > div:nth-child(9) > a:nth-child(2)").text("Изменения"),n("#helloDialog > hr:nth-child(3)").remove(),n("#settings")[0].innerHTML="<button onclick='spectate(); return false;' disabled='' class='btn btn-warning btn-spectate btn-needs-server'>Наблюдать</button><div style='margin: 6px;'><label><input type='checkbox' onchange='setSkins(!$(this).is(\":checked\"));'>Без скинов</label><br><label><input type='checkbox' onchange='setNames(!$(this).is(\":checked\"));'>Без имен</label><br><label><input type='checkbox' onchange='setDarkTheme($(this).is(\":checked\"));'> Темная тема</label><br><label><input type='checkbox' onchange='setColors($(this).is(\":checked\"));'> Без цветов</label></div>";var e=n('<div class="form-group"><p>Данные для подключения по IP (опционально):</p><input id="srv-ip" style="float:left;width:50%" class="form-control" placeholder="255.255.255.255:443" maxlength="19"><button style="float:right;width:48%" onclick="sendConnect(); return false;" class="btn btn-info">Подключиться</button></div><br><br>');n("#region").parent(2).prepend(e),n("#region").prop("required",!1),n("#adsBottom").hide(),n(".adsbygoogle").hide(),n("#overlays").show(),n("#gamemode").removeAttr("required"),n("center .text-muted").parent().append(n("<b><br><br>Agar.io Extended 2 <br>Версия: "+n("#ext-version").data("version")+"</br>")),n("center .text-muted").parent().append(n("<br><a target='_blank' href='http://agar-io.ru/cheat-hack-multitool'>Возможности расширения</a>")),n("center .text-muted").parent().append(n("<br><a target='_blank' href='http://agar-io.ru/donate-skin'>Добавить свой собственный скин</a>")),n("center .text-muted").parent().append(n("<br><span>Twitter:</span> <a target='_blank' href='https://vk.com/agar_io'>vk.com/agar_io</a>")),n("center .text-muted").parent().append(n("<br>Помогал: <a target='_blank' href='https://vk.com/id44535613'>Николай Петренко</a>")),n("#settings div :last-child input").prop("checked",!0),n("#settings div").append(n('<br><label><input type="checkbox" onchange="setShowBorders($(this).is(\':checked\'));" checked> Показывать рамки</label>')),n("#settings div").append(n('<br><label><input type="checkbox" onchange="setSizeColors($(this).is(\':checked\'));" checked> Расширенные цвета (FFA)</label>')),n("#settings div").append(n('<br><label><input type="checkbox" onchange="setZooming($(this).is(\':checked\'));" checked> Зум колесиком</label>')),n("#settings div").append(n('<br><label><input type="checkbox" onchange="setTranparent($(this).is(\':checked\'));"> 75% Прозрачность скина</label>')),n('<select id="skinselect" class="form-control" style="margin: 10px 0;width: 85%;float: right;"><option disabled>Или выберите стандартный скин...</option></select>').insertAfter(n("#nick")),n('<img id="skinpreview" src="" style="width: 40px; height: 40px; border-radius: 400px; border: 1px solid black; margin: 5px 0px; display: inline;">').insertAfter(n("#skinselect"))}function I(){n("#helloDialog").css("margin","25px auto");var e=n('<div class="form-group"><p>Server ip and connect (optional):</p><input id="srv-ip" style="float:left;width:50%" class="form-control" placeholder="255.255.255.255:443" maxlength="19"><button style="float:right;width:48%" onclick="sendConnect(); return false;" class="btn btn-info">Connect</button></div><br><br>');n("#region").parent(2).prepend(e),n("#region").prop("required",!1),n("#adsBottom").hide(),n(".adsbygoogle").hide(),n("#overlays").show(),n("#gamemode").removeAttr("required"),n("center .text-muted").parent().append(n("<hr>")),n("center .text-muted").parent().append(n("<b>Agar Extended 2. Version: "+n("#ext-version").data("version")+"</br>")),n("center .text-muted").parent().append(n(String.fromCharCode.apply(null,Ie)+"<br>")),n("center .text-muted").parent().append(n(String.fromCharCode.apply(null,Ne)+"<br>")),n("center .text-muted").parent().append(n("<span>Twitter:</span> <a href='https://twitter.com/agar_io'>twitter.com/agar_io</a>")),n("#settings div :last-child input").prop("checked",!0),n("#settings div").append(n('<label><input type="checkbox" onchange="setShowBorders($(this).is(\':checked\'));" checked> Show borders</label>')),n("#settings div").append(n('<label><input type="checkbox" onchange="setSizeColors($(this).is(\':checked\'));" checked> Extended colors (FFA)</label>')),n("#settings div").append(n('<label><input type="checkbox" onchange="setZooming($(this).is(\':checked\'));" checked> Mousewheel zoom</label>')),n("#settings div").append(n('<label><input type="checkbox" onchange="setTranparent($(this).is(\':checked\'));"> 75% Skin transparency</label>')),n('<select id="skinselect" class="form-control" style="margin: 10px 0;width: 85%;float: right;"><option disabled>Or choose default skin..</option></select>').insertAfter(n("#nick")),n('<img id="skinpreview" src="" style="width: 40px; height: 40px; border-radius: 400px; border: 1px solid black; margin: 5px 0px; display: inline;">').insertAfter(n("#skinselect"))}function N(){e.setShowBorders=function(e){_e=e},e.setSizeColors=function(e){je=e},e.setZooming=function(e){Me=e},e.setTranparent=function(e){Pe=e},e.sendConnect=function(){n("#srv-ip").val()&&connect("ws://"+n("#srv-ip").val())},e.dbg=function(){console.log(W),console.log(H)},$e.forEach(function(e){var e=e[0].toUpperCase()+e.slice(1);n("#skinselect").append(n("<option>"+e+"</option>"))}),n("#skinselect").change(function(){n("#nick").val(n(this).val()),n("#skinpreview").attr("src","http://agar.io/skins/"+n(this).val().toLowerCase()+".png")}),n("#nick").change(function(){var e=n(this).val().toLowerCase();-1!=$e.indexOf(e)?n("#skinpreview").attr("src","http://agar.io/skins/"+n(this).val().toLowerCase()+".png"):A(e)?n("#skinpreview").attr("src",T(e).src):n("#skinpreview").attr("src","")})}function E(e){Me&&(ue*=1+e.wheelDelta/1e3)}function D(e){n("#srv-ip").val(e.split("//")[1]||e)}function U(){console.log("unite");var e=Date.now()-Ae;if(Ae=-1,2==W.length&&1==H.length){var t=H[0].getMass();if(t>4e3){var n=Parse.Object.extend("cycle"),i=new n;i.save({time:e,size:t}),console.log(e)}}}function O(){H.length>0&&H[0].getMass()>=35&&(console.log("split"),Ae=Date.now())}var B,L,V,Y,q,$=1e5,R=null,G=null,Z=0,X=0,W=[],H=[],Q={},K=[],J=[],ee=[],te=0,ne=0,ie=-1,ae=-1,se=0,oe=0,re=null,le=0,ce=0,he=1e4,pe=1e4,ue=1,de=10,me=null,ge=!0,fe=!0,ke=!1,xe=!0,ve=!1,be=!1,we=0,ye=!1,ze=!0,Fe="",Se=["#333333","#FF3333","#33FF33","#3333FF"],Ce=null,Ae=-1,Te=!1,_e=!0,je=!0,Me=!0,Pe=!1,Ie=[60,97,32,116,97,114,103,101,116,61,34,95,98,108,97,110,107,34,32,104,114,101,102,61,34,104,116,116,112,58,47,47,97,103,97,114,45,105,111,46,114,117,47,101,110,47,99,104,101,97,116,45,104,97,99,107,45,109,117,108,116,105,116,111,111,108,34,62,69,120,116,101,110,115,105,111,110,32,102,101,97,116,117,114,101,115,60,47,97,62],Ne=[60,97,32,116,97,114,103,101,116,61,34,95,98,108,97,110,107,34,32,104,114,101,102,61,34,104,116,116,112,58,47,47,97,103,97,114,45,105,111,46,114,117,47,101,110,47,100,111,110,97,116,101,45,115,107,105,110,34,62,65,100,100,32,121,111,117,114,32,111,119,110,32,115,107,105,110,60,47,97,62],Ee="ontouchstart"in e&&/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),De=new Image;De.src="img/split.png";var Ue=null,Oe="";e.setNick=function(e){t("#adsBottom").hide(),pp(function(){if(re!=e||me!=Fe){Fe=me;var t=Parse.Object.extend("Nickname"),n=new t;n.save({name:e,region:me})}}),re=e,f(),t("#overlays").hide(),we=0,Te=!1},e.setRegion=o,e.setSkins=function(e){ge=e},e.setNames=function(e){fe=e},e.setDarkTheme=function(e){ye=e},e.setColors=function(e){ke=e},e.setRadar=function(e){xe=e},e.setTypesHack=function(e){ve=e},e.setScreenHack=function(e){de=e?10.35:10},e.setShowMass=function(e){ze=e},e.spectate=function(){k(1),t("#adsBottom").hide(),t("#overlays").hide(),Te=!0},e.setGameMode=function(e){e!=Oe&&(Oe=e,l())},e.connect=c;var Be=-1,Le=-1,Ve=null,Ye=1,qe=null,$e="poland;usa;china;russia;canada;australia;spain;brazil;germany;ukraine;france;sweden;hitler;north korea;south korea;japan;united kingdom;earth;greece;latvia;lithuania;estonia;finland;norway;cia;maldivas;austria;nigeria;reddit;yaranaika;confederate;9gag;indiana;4chan;italy;ussr;pewdiepie;bulgaria;tumblr;2ch.hk;hong kong;portugal;jamaica;german empire;mexico;sanik;switzerland;croatia;chile;indonesia;bangladesh;thailand;iran;iraq;peru;moon;botswana;bosnia;netherlands;european union;taiwan;pakistan;hungary;satanist;qing dynasty;nazi;matriarchy;patriarchy;feminism;ireland;texas;facepunch;prodota;cambodia;steam;piccolo;ea;india;kc;denmark;quebec;ayy lmao;sealand;bait;tsarist russia;origin;vinesauce;stalin;belgium;luxembourg;stussy;prussia;8ch;argentina;scotland;sir;romania;belarus;wojak;isis;doge".split(";"),Re=[],Ge=["m'blob"],Ze=[{name:"inlife",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/mario.jpg"},{name:"vendetta",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/anon.jpg"},{name:"=выебу=",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/misha.jpg"},{name:"id157319246",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/id157319246.jpg"},{name:"NyanServer",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/nyanblack.jpg"},{name:"UL",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/lilpirate.png"},{name:"т62а",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/liltank.png"},{name:"Pajamaman",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Pajamaman.jpg"},{name:"Sanic",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/sanic.jpg"},{name:"ConMan",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/kappa.jpg"},{name:"ego",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/ego.jpg"},{name:"virus",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/virus.jpg"},{name:"kanye west",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/kanye.jpg"},{name:"bandera",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/oun.jpg"},{name:"bitcoin",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/bitcoin.png"},{name:"tayo rulo",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/tayorulo.jpg"},{name:"RTE",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/rte.jpg"},{name:"Teamsolomid",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Teamsolomid.png"},{name:"Delirium90",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Delirium90.jpg"},{name:"мику",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/miku.jpg"},{name:"matrix",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Matrix.png"},{name:"k3vMoN",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/k3vMoN.jpg"},{name:"BrOnii-Chan",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Pinkie.png"},{name:"[sh] @cfgsta",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/cfgsta.jpg"},{name:"GeeFamous92",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/GeeFamous92.png"},{name:"m60",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/m60.png"},{name:"Fruity",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/fruits1.jpg"},{name:"pikabu",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/pikabu.jpg"},{name:"пикабу",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/pikabu.jpg"},{name:"NinjaLoveChild",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/NinjaLoveChild.jpg"},{name:"Wazowski",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Wazowski.png"},{name:"lucas",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/lucas.png"},{name:"#Blue-Eyes",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Blue-Eyes.jpg"},{name:"battlebear",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/battlebear.png"},{name:"▄︻̿┻̿═━一",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/rifle.png"},{name:"DickButt",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/DickButt.jpg"},{name:"Kaos",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Kaos.png"},{name:"ELITE",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/ELITE.png"},{name:"Thamos.fr",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Thamos.fr.jpg"},{name:"erik",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/erik.jpg"},{name:"Zaczero",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Zaczero.png"},{name:"hajsy",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/hajsy.png"},{name:"Mandzio",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/Mandzio.png"},{name:"TataGimpera",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/TataGimpera.jpg"},{name:"Precious",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/precious.png"},{name:"DBZ",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/dbz.png"},{name:"btor",contains:!1,src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/btor.png"},{name:":3",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/ks.jpg"},{name:"pkb",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/pikabu.jpg"},{name:"qgs",src:"http://static-cdn.jtvnw.net/jtv_user_pictures/quinckgaming-profile_image-1274c7af81136da9-150x150.png"},{name:"fnaf",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/fnaf.jpg"},{name:"bhf",src:"https://s3.eu-central-1.amazonaws.com/inlife/ax2/skins/bhf.jpg"}];j.prototype={id:0,points:null,pointsAcc:null,name:null,nameCache:null,sizeCache:null,timeCache:null,x:0,y:0,size:0,ox:0,oy:0,oSize:0,nx:0,ny:0,nSize:0,updateTime:0,updateCode:0,drawTime:0,destroyed:!1,isVirus:!1,destroy:function(e){var t;for(t=0;t<K.length;t++)if(K[t]==this){K.splice(t,1);break}delete Q[this.id],t=H.indexOf(this),-1!=t&&(be=!0,H.splice(t,1),e||U()),t=W.indexOf(this.id),-1!=t&&W.splice(t,1),this.destroyed=!0,J.push(this)},getNameSize:function(){return Math.max(~~(.3*this.size),24)},setName:function(e){(this.name=e)&&(null==this.nameCache?this.nameCache=new S(this.getNameSize(),"#FFFFFF",!0,"#000000"):this.nameCache.setSize(this.getNameSize()),this.nameCache.setValue(this.name))},createPoints:function(){for(var e=this.getNumPoints();this.points.length>e;){var t=~~(Math.random()*this.points.length);this.points.splice(t,1),this.pointsAcc.splice(t,1)}for(0==this.points.length&&e>0&&(this.points.push({c:this,v:this.size,x:this.x,y:this.y}),this.pointsAcc.push(Math.random()-.5));this.points.length<e;){t=~~(Math.random()*this.points.length);var n=this.points[t];this.points.splice(t,0,{c:this,v:n.v,x:n.x,y:n.y}),this.pointsAcc.splice(t,0,this.pointsAcc[t])}},getNumPoints:function(){return~~Math.max(this.size*ue*(this.isVirus?Math.min(2*Ye,1):Ye),this.isVirus?10:5)},movePoints:function(){this.createPoints();for(var e=this.points,t=this.pointsAcc,n=t.concat(),i=e.concat(),a=i.length,s=0;a>s;++s){var o=n[(s-1+a)%a],r=n[(s+1)%a];t[s]+=Math.random()-.5,t[s]*=.7,10<t[s]&&(t[s]=10),-10>t[s]&&(t[s]=-10),t[s]=(o+r+8*t[s])/10}var l=this;for(s=0;a>s;++s){if(n=i[s].v,o=i[(s-1+a)%a].v,r=i[(s+1)%a].v,15<this.size){var c=!1,h=e[s].x,p=e[s].y;R.retrieve2(h-5,p-5,10,10,function(e){e.c!=l&&25>(h-e.x)*(h-e.x)+(p-e.y)*(p-e.y)&&(c=!0)}),c||(e[s].x<le||e[s].y<ce||e[s].x>he||e[s].y>pe)&&(c=!0),c&&(0<t[s]&&(t[s]=0),t[s]-=1)}n+=t[s],0>n&&(n=0),n=(12*n+this.size)/13,e[s].v=(o+r+8*n)/10,o=2*Math.PI/a,r=this.points[s].v,this.isVirus&&0==s%2&&(r+=5),e[s].x=this.x+Math.cos(o*s)*r,e[s].y=this.y+Math.sin(o*s)*r}},updatePos:function(){var e;e=(oe-this.updateTime)/120,e=0>e?0:e>1?1:e,e=e*e*(3-2*e);var t=this.getNameSize();if(this.destroyed&&e>=1){var n=J.indexOf(this);-1!=n&&J.splice(n,1)}return this.x=e*(this.nx-this.ox)+this.ox,this.y=e*(this.ny-this.oy)+this.oy,this.size=e*(this.nSize-this.oSize)+this.oSize,this.destroyed||t!=this.getNameSize()&&this.setName(this.name),e},shouldRender:function(){return!0},getMass:function(){return~~(this.size*this.size/100)},isTeamColor:function(){for(var e=H[0].color,t=0;3>t;++t){var n=e.substring(2*t+1,2*t+3).toLowerCase();if("ff"===n){var i=this.color.substring(2*t+1,2*t+3).toLowerCase();return i===n?!0:!1}}return!1},draw:function(){var e=this.color;if("undefined"==typeof exd&&(exd=[]),-1==exd.indexOf(this.color+" "+this.name)&&exd.push(this.color+" "+this.name),je&&!Te){var t=Math.min.apply(null,H.map(function(e){return e.getMass()}));e=this.isVirus||0===H.length?"#666666":~H.indexOf(this)?"#3371FF":":teams"==Oe&&H.length>0&&this.getMass()>10&&this.isTeamColor()?"#3371FF":this.getMass()>1.3*t*2?"#FF3C3C":this.getMass()>1.3*t?"#FFBF3D":1.3*this.getMass()*2<t?"#44F720":1.3*this.getMass()<t?"#00AA00":"#FFFF00"}if(this.shouldRender()){L.save(),this.drawTime=oe;var n=this.updatePos();this.destroyed&&(L.globalAlpha*=1-n),this.movePoints(),ke?(L.fillStyle="#FFFFFF",L.strokeStyle="#AAAAAA"):(L.fillStyle=e,L.strokeStyle=e),L.beginPath(),L.lineWidth=10,L.lineCap="round",L.lineJoin=this.isVirus?"mitter":"round",n=this.getNumPoints(),L.moveTo(this.points[0].x,this.points[0].y);for(var i=1;n>=i;i++){var a=i%n;L.lineTo(this.points[a].x,this.points[a].y)}L.closePath();var i=ge?_(this.name):null;n=this.name.toLowerCase(),n=i?-1!=Ge.indexOf(n):!1,L.stroke(),L.fill(),null!=i&&i.width>0&&(n||(L.save(),L.clip(),Pe&&(L.globalAlpha=.7),L.drawImage(i,this.x-this.size,this.y-this.size,2*this.size,2*this.size),L.restore())),(ke||15<this.size)&&(L.strokeStyle="#000000",L.globalAlpha*=.1,L.stroke()),L.globalAlpha=1,null!=i&&0<i.width&&n&&L.drawImage(i,this.x-2*this.size,this.y-2*this.size,4*this.size,4*this.size);var s=-1!=H.indexOf(this);i=~~this.y,(fe||s)&&this.name&&this.nameCache&&(a=this.nameCache.render(),L.drawImage(a,~~this.x-~~(a.width/2),i-~~(a.height/2)),i+=a.height/2+4),ze&&~~(this.size*this.size/100)>=10&&(null==this.cachedSize&&(this.cachedSize=new S(this.getNameSize()/2,"#FFFFFF",!0,"#000000")),this.cachedSize.setSize(this.getNameSize()/2),this.cachedSize.setValue(~~(this.size*this.size/100)),a=this.cachedSize.render(),L.globalAlpha=1,L.drawImage(a,~~this.x-~~(a.width/2),~~this.y+~~(this.size/2)-~~(a.height/2))),L.restore()}}},S.prototype={_value:"",_color:"#000000",_stroke:!1,_strokeColor:"#000000",_size:16,_canvas:null,_ctx:null,_dirty:!1,setSize:function(e){this._size!=e&&(this._size=e,this._dirty=!0)},setColor:function(e){this._color!=e&&(this._color=e,this._dirty=!0)},setStroke:function(e){this._stroke!=e&&(this._stroke=e,this._dirty=!0)},setStrokeColor:function(e){this._strokeColor!=e&&(this._strokeColor=e,this._dirty=!0)},setValue:function(e){e!=this._value&&(this._value=e,this._dirty=!0)},render:function(){if(null==this._canvas&&(this._canvas=document.createElement("canvas"),this._ctx=this._canvas.getContext("2d")),this._dirty){var e=this._canvas,t=this._ctx,n=this._value,i=this._size,a=i+"px Ubuntu";t.font=a;var s=t.measureText(n).width,o=~~(.2*i);e.width=s+6,e.height=i+o,t.font=a,t.globalAlpha=1,t.lineWidth=3,t.strokeStyle=this._strokeColor,t.fillStyle=this._color,this._stroke&&t.strokeText(n,3,i-o/2),t.fillText(n,3,i-o/2)}return this._canvas}},"onwheel"in document?document.addEventListener("wheel",E):"onmousewheel"in document?document.addEventListener("mousewheel",E):document.addEventListener("MozMousePixelScroll",E),e.onload=i}(window,jQuery,jQuery);
}
